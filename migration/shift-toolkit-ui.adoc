---
sidebar: sidebar 
permalink: migration/shift-toolkit-ui.html 
keywords: netapp, vmware, esxi, vm, migration, openshift, virtualization, hyper-v, proxmox 
summary:  
---
= Shift Toolkit を構成する
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
VM の移行または変換を自動化するように Shift Toolkit を構成します。このプロセスには、ソース サイトと宛先サイトの追加、ストレージの構成、VM のリソース グループへのグループ化、移行ブループリントの作成、移行のスケジュール設定が含まれます。



== 実行シフトツールキット

* ブラウザを使用してShiftツールキットUIにアクセスするには、"http://<IP[]インストール時に指定されたアドレス>:3001"
+

NOTE: 最適なエクスペリエンスを得るには、Google Chrome または Internet Explorer を使用してください。

* 以下のデフォルトの資格情報を使用して UI にアクセスします。
+
ユーザー名: admin

+
パスワード: admin




NOTE: 管理者の資格情報は、「パスワードの変更」オプションを使用して変更できます。

image:shift-toolkit-018.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

「同意して続行」をクリックして、法的 EULA に同意します。

image:shift-toolkit-019.png["入出力ダイアログまたは書かれたコンテンツを示す図"]



== Shiftツールキットの構成

ソース ハイパーバイザーと宛先ハイパーバイザーの両方へのストレージと接続が適切に構成されたら、 FlexClone機能を活用して仮想マシン VMDK の適切な形式への移行または変換を自動化するように Shift ツールキットの構成を開始します。



=== サイトを追加

最初のステップは、ソース vCenter を検出して Shift ツールキットに追加し、次にターゲット Hyper-V の詳細 (ハイパーバイザーとストレージの両方) を検出して追加することです。サポートされているブラウザで Shift ツールキットを開き、デフォルトのユーザー名とパスワード (admin/admin) を使用して、「サイトの追加」をクリックします。

image:shift-toolkit-020.png["入出力ダイアログまたは書かれたコンテンツを示す図"]


NOTE: 検出オプションを使用してサイトを追加することもできます。

次のプラットフォームを追加します。

*ソース*

* ソースサイトの詳細
+
** サイト名 - サイトの名前を入力します
** ハイパーバイザー – ソースとして VMware を選択 (GA 期間中にのみ利用可能なオプション)
** サイトの場所 – デフォルトのオプションを選択
** コネクタ – デフォルトの選択を選択




入力したら、「続行」をクリックします。

image:shift-toolkit-021.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

* ソース vCenter
+
** エンドポイント - vCenter ServerのIPアドレスまたはFQDNを入力します
** ユーザー名 - vCenter にアクセスするためのユーザー名 (UPN 形式: `username@domain.com` ）
** vCenter パスワード – リソースのインベントリを実行するために vCenter にアクセスするためのパスワード。
** vCenter SSL サムプリント（オプション）




「自己署名証明書を受け入れる」を選択し、「続行」をクリックします。

image:shift-toolkit-022.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

* ONTAPストレージシステムの認証情報


image:shift-toolkit-023.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

追加されると、Shift ツールキットは自動検出を実行し、関連するメタデータ情報とともに VM を表示します。  Shift ツールキットは、VM で使用されるネットワークとポート グループを自動的に検出し、それらを入力します。


NOTE: ソース サイトに変更が加えられた場合は、必ず検出を実行して最新の情報を取得してください。これを行うには、サイト名の横にある 3 つのドットをクリックし、「サイトの検出」をクリックします。


NOTE: VM インベントリは 24 時間ごとに自動更新されます。

image:shift-toolkit-024.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

特定の vCenter のデータを表示するには、ダッシュボードに移動し、適切なサイト名に対して「VM リストの表示」をクリックします。このページには、VM インベントリと VM 属性が表示されます。

次のステップは、宛先ハイパーバイザーを追加することです。追加するには、「新しいサイトの追加」をクリックし、「宛先」を選択します。

*行き先*

image:shift-toolkit-025.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

* 目的地サイトの詳細
+
** サイト名 - サイトの名前を入力します
** ハイパーバイザー – ターゲットとしてHyper-VまたはKVMを選択
** サイトの場所 – デフォルトのオプションを選択
** コネクタ – デフォルトの選択を選択




入力したら、「続行」をクリックします。

image:shift-toolkit-026.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

ハイパーバイザーの選択に基づいて、必要な詳細を入力します。

* 宛先 Hyper-V の詳細
+
** Hyper-V スタンドアロンまたはフェールオーバー クラスター マネージャーの IP アドレスまたは FQDN
** ユーザー名 - アクセスするユーザー名（UPN形式： `username@domain.com`またはドメイン\管理者)
+
パスワード – リソースのインベントリを実行するために Hyper-V ホストまたは FCI インスタンスにアクセスするためのパスワード。

+
「自己署名証明書を受け入れる」を選択し、「続行」をクリックします。





image:shift-toolkit-027.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

完了したら、「続行」をクリックします。


NOTE: 現在のリリースでは、Shift ツールキットは System Center と直接通信しません。


NOTE: Hyper-V FCI とホスト検出は DNS 解決に依存します。ホスト名が Shift ツールキット VM から解決可能であることを確認します。解決に失敗した場合は、ホスト ファイル (C:\Windows\System32\drivers\etc\hosts) を更新し、検出操作を再試行してください。

* ONTAPストレージシステム*

image:shift-toolkit-028.png["入出力ダイアログまたは書かれたコンテンツを示す図"]


NOTE: ディスク形式の変換はボリューム レベルで同じボリューム内で行われるため、ソースと宛先のストレージ システムは同じである必要があります。

image:shift-toolkit-029.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

次のステップでは、必要な VM をリソース グループとして移行グループにグループ化します。



== リソースのグループ化

プラットフォームを追加したら、移行または変換する VM をリソース グループにグループ化します。  Shift ツールキットのリソース グループを使用すると、依存する VM のセットを、ブート順序とブート遅延を含む論理グループにグループ化できます。


NOTE: リソース グループを作成する前に、Qtree がプロビジョニングされていることを確認します (前提条件のセクションで説明されているとおり)。

リソース グループの作成を開始するには、「新しいリソース グループの作成」メニュー項目をクリックします。

. リソース グループにアクセスし、「新しいリソース グループの作成」をクリックします。
+
image:shift-toolkit-030.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. 「新しいリソース グループ」で、ドロップダウンからソース サイトを選択し、「作成」をクリックします。
. リソース グループの詳細を指定し、ワークフローを選択します。ワークフローには2つのオプションがあります
+
.. クローンベースの移行 - ソースハイパーバイザーから宛先ハイパーバイザーへの VM のエンドツーエンドの移行を実行します。
.. クローンベースの変換 - 選択したハイパーバイザー タイプへのディスク フォーマットの変換を実行します。
+
image:shift-toolkit-031.png["入出力ダイアログまたは書かれたコンテンツを示す図"]



. 「続行」をクリックします
. 検索オプションを使用して適切な VM を選択します。デフォルトのフィルター オプションは「データストア」です。
+

NOTE: 変換前に、変換または移行する VM を、新しく作成されたONTAP SVM 上の指定されたデータストアに移動します。これにより、本番環境の NFS データストアを分離することができ、指定されたデータストアを仮想マシンのステージングに使用できるようになります。

+
image:shift-toolkit-032.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

+

NOTE: このコンテキストのデータストア ドロップダウンには、NFSv3 データストアのみが表示されます。  NFSv4 データストアは表示されません。

+
image:shift-toolkit-033.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. 「宛先サイト」、「宛先 Hyper-V エントリ」、およびデータストアから Qtree へのマッピングを選択して、移行の詳細を更新します。
+
image:shift-toolkit-034.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

+

NOTE: ESXからHyper-VへVMを変換する際は、変換後のVMが保存される宛先パスが適切なqtreeに設定されていることを確認してください。

+

NOTE: 複数の qtree を作成し、それに応じて変換された VM ディスクを保存するために使用できます。

. 選択したすべての VM のブート順序とブート遅延 (秒) を選択します。各仮想マシンを選択し、その優先順位を設定することで、電源オンシーケンスの順序を設定します。  3 はすべての仮想マシンのデフォルト値です。
+
オプションは次のとおりです。

+
1 – 最初にパワーオンする仮想マシン 3 – デフォルト 5 – 最後にパワーオンする仮想マシン

+
image:shift-toolkit-035.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. 「リソース グループの作成」をクリックします。
+
image:shift-toolkit-036.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

+

NOTE: 仮想マシンを追加または削除するためにリソース グループを変更する必要がある場合は、リソース グループ名の横にある 3 つのドットを使用して、「リソース グループの編集」を選択します。





=== 設計図

仮想マシンを移行または変換するには、計画が必要です。ドロップダウンからソースおよび宛先のハイパーバイザー プラットフォームを選択し、このブループリントに含めるリソース グループと、アプリケーションの電源をオンにする方法のグループ化 (ドメイン コントローラー、次に Tier-1、次に Tier-2 など) を選択します。これらは移行計画とも呼ばれることがあります。ブループリントを定義するには、「ブループリント」タブに移動し、「新しいブループリントの作成」をクリックします。

ブループリントの作成を開始するには、「新しいブループリントを作成」をクリックします。

. ブループリントにアクセスし、「新しいブループリントを作成」をクリックします。
+
image:shift-toolkit-037.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. 「新しいブループリント」で、プランの名前を指定し、ソース サイト > 関連する vCenter、宛先サイト、および関連する Hyper-V ハイパーバイザーを選択して、必要なホスト マッピングを追加します。
. マッピングが完了したら、クラスターとホストのマッピングを選択します。
+
image:shift-toolkit-038.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. リソース グループの詳細を選択し、「続行」をクリックします。
+
image:shift-toolkit-039.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. リソース グループの実行順序を設定します。このオプションを使用すると、複数のリソース グループが存在する場合に操作のシーケンスを選択できます。
. 完了したら、適切な仮想スイッチへのネットワーク マッピングを選択します。仮想スイッチは Hyper-V 内ですでにプロビジョニングされている必要があります。
+
image:shift-toolkit-040.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

+

NOTE: Hyper-V 側では、仮想スイッチ タイプ「外部」がネットワーク選択で唯一サポートされているオプションです。

+

NOTE: テスト移行の場合、「ネットワークを構成しない」がデフォルトで選択されており、Shift ツールキットは IP アドレスの割り当てを実行しません。ディスクが変換され、Hyper-V 側で仮想マシンを購入したら、実稼働ネットワークとの衝突を避けるためにバブル ネットワーク スイッチを手動で割り当てます。

+
image:shift-toolkit-041.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

. VM の選択に基づいて、ストレージ マッピングが自動的に選択されます。
+

NOTE: 仮想マシンを SMB 共有から作成してパワーオンできるように、qtree が事前にプロビジョニングされ、必要な権限が割り当てられていることを確認してください。

. VM の詳細で、各 OS タイプに対してサービス アカウントと有効なユーザー資格情報を指定します。これは、仮想マシンに接続して、VMware ツールの削除や IP 構成の詳細のバックアップに必要な特定のスクリプトを作成および実行するために使用されます。
+
.. Windows ベースの OS の場合は、ローカル管理者権限を持つユーザーを使用することをお勧めします。ドメイン資格情報も使用できますが、変換前に VM にユーザー プロファイルが存在することを確認してください。そうでない場合、ネットワークが接続されていないときにドメイン認証が検索されるため、ドメイン資格情報は機能しません。
.. Linux ディストリビューションベースのゲスト VM の場合、パスワードなしで sudo コマンドを実行できるユーザーを指定します。つまり、そのユーザーは sudoers リストの一部であるか、/etc/sudoers.d/ フォルダーに新しい構成ファイルとして追加されている必要があります。
+
image:shift-toolkit-042.png["入出力ダイアログまたは書かれたコンテンツを示す図"]



. 再度、VM の詳細の下で、関連する IP 構成オプションを選択します。デフォルトでは、「構成しない」が選択されています。
+
.. ソース システムから同じ IP を持つ VM を移行するには、「IP を保持」を選択します。
.. ソース システムで静的 IP を使用して VM を移行し、ターゲット VM に DHCP を割り当てるには、「DHCP」を選択します。
+
この機能が動作するには、次の要件が満たされていることを確認してください。

+
*** 準備 VM フェーズ中およびスケジュールされた移行時間まで VM の電源がオンになっていることを確認します。
*** VMware VM の場合は、VMware Tools がインストールされていることを確認します。
*** cron ジョブを作成するには、Windows OS では管理者権限を持つアカウント、Linux ベースのディストリビューション OS ではパスワード オプションなしの sudo 権限を持つアカウントによって、ソース VM 上で準備スクリプトが実行されていることを確認します。




. 次のステップは VM の構成です。
+
.. オプションで VM の CPU/RAM パラメータのサイズを変更します。これはサイズ変更に非常に役立ちます。
.. ブート順序のオーバーライド: リソース グループ全体で選択されたすべての VM のブート順序とブート遅延 (秒) も変更します。これは、リソース グループのブート順序の選択時に選択した内容から変更が必要な場合に、ブート順序を変更するための追加オプションです。デフォルトでは、リソース グループの選択時に選択されたブート順序が使用されますが、この段階で変更を加えることができます。
.. パワーオン: ワークフローで仮想マシンをパワーオンしない場合は、このオプションをオフにします。デフォルトのオプションは ON で、VM の電源がオンになることを意味します。
.. VMware ツールを削除します。Shift ツールキットは、変換後に VMware ツールを削除します。このオプションはデフォルトで選択されています。顧客独自のカスタマイズされたスクリプトを実行する予定の場合は、これを選択解除できます。
.. 世代: Shift ツールキットは次の経験則を使用して、適切なものをデフォルトに設定します (Gen1 > BIOS、Gen2 > EFI)。このオプションは選択できません。
.. MAC を保持: それぞれの VM の MAC アドレスを保持することで、MAC に依存するアプリケーションのライセンスの課題を克服できます。
.. サービス アカウントのオーバーライド: このオプションを使用すると、グローバル サービス アカウントを使用できない場合に別のサービス アカウントを指定できます。
+
image:shift-toolkit-043.png["入出力ダイアログまたは書かれたコンテンツを示す図"]



. 「続行」をクリックします。
. 次のステップでは、チェックボックスを選択して日時を設定し、移行をスケジュールします。予定日までにすべての仮想マシン (VM) が準備され、電源がオフになっていることを確認します。完了したら、「ブループリントを作成」をクリックします。
+
image:shift-toolkit-044.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

+

NOTE: スケジュールを設定するときは、現在の Shift VM 時間より少なくとも 30 分先の日付を選択します。これは、ワークフローがリソース グループ内の VM を準備するのに十分な時間を確保するためです。

. ブループリントが作成されると、prepareVMジョブが開始され、移行の準備としてソースVM上でスクリプトが自動的に実行されます。
+
image:shift-toolkit-045.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

+
このジョブは、invoke-VMScript メソッドを使用してスクリプトを実行し、VMware ツールを削除し、IP アドレス、ルート、DNS 情報などのネットワーク構成の詳細をバックアップするために必要なスクリプトをコピーします。これらのスクリプトは、ターゲット VM で同じ設定を維持するために使用されます。

+
** Windows ベースのオペレーティング システムの場合、準備スクリプトが保存されるデフォルトの場所は「C:\ NetApp」フォルダーです。
+
image:shift-toolkit-046.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

** Linux ベースの VM の場合、準備スクリプトが保存されるデフォルトの場所は / NetAppと /opt ディレクトリです。
+
image:shift-toolkit-047.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

+

NOTE: CentOS または Red Hat を実行している Linux ソース VM の場合、Shift ツールキットは必要な Hyper-V ドライバーを自動的にインストールするインテリジェントな機能を備えています。変換後に VM が正常に起動できるようにするには、ディスク変換前にこれらのドライバーがソース VM に存在している必要があります。

+

NOTE: 詳細については、link:https://access.redhat.com/solutions/3465011["RHEL VM を Hyper-V に移行した後、システムが Dracut で停止する"] 。

+
PrepareVM ジョブが正常に完了すると (下のスクリーンショットを参照)、VM の移行準備が整い、ブループリントのステータスが「アクティブ」に更新されます。

+
image:shift-toolkit-048.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

+
image:shift-toolkit-049.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

+
移行は設定された時間に実行されるか、「移行」オプションをクリックして手動で開始できます。







== 監視とダッシュボード

ジョブ監視を使用してジョブのステータスを監視します。

image:shift-toolkit-076.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

直感的な UI により、移行、変換、ブループリントのステータスを自信を持って評価できます。これにより、管理者は、移行または変換された VM の数とともに、成功した計画、失敗した計画、部分的に失敗した計画を迅速に特定できます。

image:shift-toolkit-077.png["入出力ダイアログまたは書かれたコンテンツを示す図"]



== 詳細設定

Shift ツールキットには、上部のツールバーの設定アイコンをクリックしてアクセスできる詳細設定が用意されています。

image:shift-toolkit-078.png["入出力ダイアログまたは書かれたコンテンツを示す図"]



=== クレドSSP

Shift は、資格情報セキュリティ サービス プロバイダー (CredSSP) を活用して資格情報の転送を管理します。変換プロセス中、Shift サーバーは、変換対象の VM のゲスト OS 上でいくつかのスクリプトを実行します。これらのスクリプトを実行するための資格情報は、Shift サーバーから Hyper-V サーバーを経由してゲスト OS に「ダブルホップ」で渡されます。

image:shift-toolkit-079.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

*Shift サーバーを CredSSP クライアントとして構成する:*

「詳細設定」ウィザードは、Shift サーバーを CredSSP クライアントとして自動的に構成します。これにより、Shift サーバーは Hyper-V サーバーに資格情報を委任できるようになります。

*舞台裏で何が起きているか:*

Shift ツールキットは、一連のコマンドを実行して自身をクライアントとして構成し、Hyper-V ホストを管理できるようにします。このプロセスには、必要な構成のセットアップが含まれます。

* 次のコマンドを実行します:
+
** Set-Item WSMan:\localhost\Client\TrustedHosts -Value "Hyper-V ホストの FQDN"
** Enable-WSManCredSSP -Role client -DelegateComputer "hyper-v-host の fqdn"


* 次のグループ ポリシーを構成します。
+
** コンピューターの構成 > 管理用テンプレート > システム > 資格情報の委任 > NTLMのみのサーバー認証で新しい資格情報の委任を許可する




[有効] を選択し、wsman/fqdn-of-hyper-v-host を追加します。

*Hyper-V サーバーを CredSSP サーバーとして構成する*

Hyper-V サーバーで Enable-WSManCredSSP コマンドレットを使用して、Hyper-V サーバーを CredSSP サーバーとして構成します。これにより、Hyper-V サーバーは Shift サーバーから資格情報を受信できるようになります。

Shift ツールキット サーバーによって仮想マシンがプロビジョニングされる Hyper-V ホストで、管理者として Windows PowerShell セッションを開き、次のコマンドを実行します。

. PSRemoting を有効にする
. Enable-WSManCredSSP -役割サーバー




=== 威勢のいい

詳細設定の Swagger ページでは、利用可能な API と対話できます。 Shift ツールキット REST API を通じて利用できるリソースは、Swagger API ドキュメント ページに表示されているように、カテゴリ別に整理されています。ここでは、各リソースの簡単な説明と基本リソース パスを示し、使用に際しての追加の考慮事項がある場合はその情報も示します。

image:shift-toolkit-080.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

*セッション*

この API を使用して、Shift ツールキット サーバーにログインできます。このAPIは、以降の要求を認証するために使用されるユーザ認証トークンを返します。

* セッションを開始する
* セッションを検証する
* すべてのセッションIDを取得する
* セッションを終了する


*コネクタ*

* コネクタを追加する
* すべてのコネクタの詳細を取得する
* IDでコネクタの詳細を更新する
* IDでコネクタの詳細を取得する


*テナント*

APIを使用して追加および取得操作を実行する

* テナントを追加
* すべてのテナントを取得


*ユーザー*

APIを使用して、追加、取得、変更、承認の操作を実行します。

* ユーザを追加
* すべてのユーザーを取得
* ユーザーのパスワードを変更する
* EULAに同意する


*CredSSP*

APIを使用して有効化および取得操作を実行する

* クレデンシャルを有効にする
* credssp のステータスを取得する


*サイト*

APIを使用して取得、追加、削除、更新操作を実行します

* サイト数を取得する
* サイトの詳細をすべて取得
* サイトを追加する
* IDでサイトの詳細を取得
* IDでサイトを削除する
* サイトに仮想環境を追加する
* サイトにストレージ環境を追加する
* サイトの仮想環境の詳細を取得する
* サイトの仮想環境の詳細を更新する
* サイトの仮想環境の詳細を削除する
* サイトのストレージ環境の詳細を取得する
* サイトのストレージ環境の詳細を更新する
* サイトのストレージ環境の詳細を削除する


*発見*

APIを使用して検出および取得操作を実行する

* ソースサイトを発見
* ソースサイトのすべての検出要求を取得する
* ターゲットサイトを発見
* 対象サイトのすべての検出要求を取得する
* ID によるソース サイトの検出手順の取得
* ID でターゲット サイトの検出手順を取得します


*VM*

APIを使用して取得操作を実行する

* ソース内のサイトと仮想環境のVMを取得する
* サイトと仮想環境の保護されていない VM を取得する
* VM数を取得する
* 保護されているVMの数を取得する


*リソース*

APIを使用して取得操作を実行する

* サイトと仮想環境のリソースの詳細を取得する
* ソースサイトのリソース数を取得する


*リソースグループ*

APIを使用して追加、更新、取得操作を実行する

* 保護グループの数を取得する
* すべての保護グループの詳細を取得する
* 保護グループを追加する
* IDで保護グループの詳細を取得する
* IDで保護グループを削除する
* ID による保護グループの詳細の更新
* ID で保護グループの VM を取得する
* 保護グループを含むブループリントを取得する


*設計図*

APIを使用して追加、更新、取得操作を実行する

* ブループリントの数を取得
* すべてのブループリントの詳細を取得する
* ブループリントを追加する
* IDで設計図の詳細を取得する
* IDでブループリントを削除する
* IDのブループリントの詳細を更新
* ブループリントのVMを取得する
* ブループリント内に存在するVMの電源ステータスを取得する
* 設計図の取得数
* すべての設計図の詳細を取得する


*コンプライアンス*

APIを使用して追加および取得操作を実行する

* ブループリントのコンプライアンスチェック結果を取得する
* ブループリントのコンプライアンス チェックの最終ステータスを取得する
* ブループリントのコンプライアンスチェックをオンデマンドで追加


*実行*

APIを使用して取得操作を実行する

* すべての実行の詳細を取得する
* 進行中の実行の詳細を取得する
* 実行回数を取得する
* 進行中の実行の数を取得する
* 実行IDのステップを取得する


*回復*

APIを使用して追加および取得操作を実行する

* ブループリントの新しい実行リクエストを追加する
* ブループリントの実行の再試行リクエストを追加する
* すべてのブループリントの実行ステータスを取得する
* ブループリントIDの実行ステータスを取得する


*スクリプトブロック*

APIを使用して取得および更新操作を実行する

* すべてのスクリプトのメタデータを取得する
* IDでスクリプトのメタデータを取得する
* すべての更新メタデータを取得する
* スクリプトの実行




=== スクリプトブロック

Shift ツールキット内のスクリプト ブロックには、利用可能な内部および外部 API を介して機能を自動化、統合、開発するのに役立つサンプル コードが提供されます。スクリプト ブロックのコード サンプル セクションで、Shift ツールキット自動化チームとコミュニティ メンバーによって作成されたサンプルを参照してダウンロードします。サンプルを使用して、自動化、管理、または統合タスクを開始します。

image:shift-toolkit-081.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

以下は、Shift UI 内で特定のジョブを削除するために使用できるサンプル PowerShell スクリプトの例です。この機能はワークフロー経由では公開されませんが、スクリプト ブロック経由では同じ機能を実現できます。同じスクリプトは、ダウンロードして呼び出すだけで簡単に実行できる bat スクリプトとしても提供されています。

image:shift-toolkit-082.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

ここでの目的は、Shift ツールキット API とそれぞれのハイパーバイザーで公開されている API を使用して、特定のハイパーバイザーに対して 0 日目と N 日目の操作を実行するサンプル スクリプトを提供することです。



== SAN環境

Shift ツールキットの主な要件として、変換する VM は NAS 環境 (ESX の場合は NFS) に存在する必要があります。  VM が SAN 環境 (iSCSI、FC、FCoE、NVMeFC) に存在する場合は、変換前に NAS 環境に移行する必要があります。

image:shift-toolkit-083.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

上記のアプローチは、VM が SAN データストアに保存される一般的な SAN 環境を示しています。  ESX から Hyper-V に変換する VM とそのディスクは、まず VMware vSphere Storage vMotion を使用して NFS データストアに移行されます。 ShiftツールキットはFlexCloneを使用して、VMをESXからHyper-Vに変換します。変換されたVM（およびそのディスク）はCIFS共有上に保存されます。変換された VM (およびそのディスク) は、Hyper-V ストレージ ライブ マイグレーションを使用して SAN 対応 CSV に移行されます。


NOTE: ノードに異なるプロセス機能セットがある場合、ライブ VM マイグレーションが失敗する可能性があります。これは、「異なるプロセッサを搭載した物理コンピューターに移行する」を設定することで対処できます。このスクリプトはスクリプト ブロックで使用できます。
