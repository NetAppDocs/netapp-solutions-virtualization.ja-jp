---
sidebar: sidebar 
permalink: migration/shift-toolkit-conversion.html 
keywords: netapp, vmware, esxi, vm, migration, openshift, virtualization, hyper-v, proxmox 
summary:  
---
= Shift Toolkit を使用して VM を変換する
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
Shift Toolkit を使用して、VMware ESX 仮想マシン ディスク (VMDK) を Microsoft Hyper-V (VHDX) ディスク形式または Red Hat KVM (QCOW2) ディスク形式に変換します。このプロセスには、リソース グループの設定、変換ブループリントの作成、変換のスケジュール設定が含まれます。



== 変換

クローンベースの変換オプションを使用すると、次のディスク形式のハイパーバイザー間で仮想ディスクを簡単に変換できます。

* VMware ESX から Microsoft Hyper-V (VMDK から VHDX)
* VMware ESX から Red Hat KVM (VMDK から QCOW2)


変換された qcow2 ファイルは、どの KVM ハイパーバイザーとも互換性があります。たとえば、qcow2 ファイルは、virt-manager を使用して VM を作成する RHEL ベースの KVM のほか、ubuntu KVM、Rocky Linux ベースの KVM などでも利用できます。同じものを、微調整を加えた Oracle Linux 仮想化マネージャーでも、またNetApp Tridentを使用してインポートした後の OpenShift 仮想化でも使用できます。目標は、ディスク（秒単位から分単位に変換）を提供し、それを組織が VM をプロビジョニングしてネットワークを割り当てるために使用する既存の自動化スクリプトに統合できるようにすることです。このアプローチは、ディスク変換が Shift ツールキット API によって処理され、残りのスクリプトで VM が起動されるため、全体的な移行時間を短縮するのに役立ちます。

今後のリリースでは、Shift ツールキットは VMware から他の互換性のある KVM ハイパーバイザーへのエンドツーエンドの移行をサポートする予定です。ただし、現在のリリースでは、UI または API を介して変換を実行できます。



=== QCOW2形式に変換する

NetApp Shift ツールキットを使用して仮想ディスクを QCOW2 形式に変換するには、次の大まかな手順に従います。

* ハイパーバイザーとして KVM を指定して、宛先サイト タイプを作成します。
+

NOTE: KVM ではハイパーバイザーの詳細は必要ありません。

+
image:shift-toolkit-057.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

* ディスク変換が必要なVMを含むリソースグループを作成します
+
image:shift-toolkit-058.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

+
image:shift-toolkit-059.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

+
image:shift-toolkit-060.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

* 仮想ディスクを QCOW2 形式に変換するためのブループリントを作成します。
+
image:shift-toolkit-061.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

+
image:shift-toolkit-062.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

+
image:shift-toolkit-063.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

* スケジュール オプションを使用してスロットを指定します。変換をアドホック ベースで実行する場合には、スケジュール オプションのチェックをオフのままにします。
+
image:shift-toolkit-064.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

* ブループリントが作成されると、prepareVM ジョブが開始され、ソース VM 上でスクリプトが自動的に実行され、変換の準備が整います。
+
image:shift-toolkit-065.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

* PrepareVM ジョブが正常に完了すると (下のスクリーンショットを参照)、VM に関連付けられた VM ディスクの変換準備が完了し、ブループリントのステータスが「アクティブ」に更新されます。
* VM に必要なダウンタイムをスケジュールした後、「変換」をクリックします。
+
image:shift-toolkit-066.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

* 変換操作では、ポイントインタイムスナップショットが使用されます。必要に応じて VM の電源をオフにしてから、操作を再トリガーします。
+
image:shift-toolkit-067.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

+
** 変換操作では、VM とそれぞれのディスクに対して各操作が実行され、適切な形式が生成されます。
+
image:shift-toolkit-068.png["入出力ダイアログまたは書かれたコンテンツを示す図"]



* 手動で VM を作成し、ディスクを VM に接続して、変換されたディスクを使用します。
+
image:shift-toolkit-069.png["入出力ダイアログまたは書かれたコンテンツを示す図"]




NOTE: Shift ツールキットは、qcow2 形式のディスク変換のみをサポートします。 VM の作成または登録はサポートされていません。変換されたディスクを使用するには、手動で VM を作成し、ディスクを接続します。



=== VHDX形式に変換する

NetApp Shift ツールキットを使用して仮想ディスクを VHDX 形式に変換するには、次の大まかな手順に従います。

* ハイパーバイザーとして Hyper-V を指定して、宛先サイト タイプを作成します。
* ディスク変換が必要なVMを含むリソースグループを作成します
+
image:shift-toolkit-070.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

+
image:shift-toolkit-071.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

* 仮想ディスクを VHDX 形式に変換するためのブループリントを作成します。ブループリントが作成されると、準備ジョブが自動的に開始されます。
+
image:shift-toolkit-072.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

* VM に必要なダウンタイムがスケジュールされたら、「変換」を選択します。
+
image:shift-toolkit-073.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

* 変換操作では、VM とそれぞれのディスクに対して各操作が実行され、適切な VHDX 形式が生成されます。
+
image:shift-toolkit-074.png["入出力ダイアログまたは書かれたコンテンツを示す図"]

* 手動で VM を作成し、ディスクを VM に接続して、変換されたディスクを使用します。
+
image:shift-toolkit-075.png["入出力ダイアログまたは書かれたコンテンツを示す図"]




NOTE: 変換された VHDX ディスクを VM で使用するには、Hyper-V マネージャーまたは PowerShell コマンドを使用して VM を手動で作成し、ディスクを VM に接続する必要があります。これに加えて、ネットワークも手動でマッピングする必要があります。
