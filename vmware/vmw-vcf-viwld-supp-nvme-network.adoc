---
sidebar: sidebar 
permalink: vmware/vmw-vcf-viwld-supp-nvme-network.html 
keywords: netapp, vmware, cloud, foundation, vcf, aff, all-flash, nfs, vvol, vvols, array, ontap tools, otv, sddc, iscsi 
summary: 'VI ワークロード ドメイン内の ESXi ホスト上の NVMe over TCP (NVMe/TCP) ストレージのネットワークを構成します。  NVMe トラフィック用の分散ポート グループを作成し、各 ESXi ホストに VMkernel アダプタを設定し、NVMe/TCP アダプタを追加して、信頼性の高い接続とマルチパスを有効にします。' 
---
= VCF VIワークロードドメイン内のESXiホストでNVMe/TCPのネットワークを構成する
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
VI ワークロード ドメイン内の ESXi ホスト上の NVMe over TCP (NVMe/TCP) ストレージのネットワークを構成します。  NVMe トラフィック用の分散ポート グループを作成し、各 ESXi ホストに VMkernel アダプタを設定し、NVMe/TCP アダプタを追加して、信頼性の高い接続とマルチパスを有効にします。

vSphere クライアントを使用して、VI ワークロード ドメイン クラスタで次の手順を実行します。この場合、vCenter Single Sign-On が使用されているため、vSphere クライアントは管理ドメインとワークロード ドメインの両方で共通になります。



== ステップ1: NVME/TCPトラフィック用の分散ポートグループを作成する

各 NVMe/TCP ネットワークに新しい分散ポート グループを作成するには、次の手順を実行します。

.手順
. vSphere クライアントから、ワークロード ドメインの *インベントリ > ネットワーク* に移動します。既存の分散スイッチに移動し、*新しい分散ポート グループ...*を作成するアクションを選択します。
+
image:vmware-vcf-asa-022.png["新しいポートグループの作成を選択"]

+
{nbsp}

. *新しい分散ポート グループ* ウィザードで、新しいポート グループの名前を入力し、*次へ* をクリックして続行します。
. *設定の構成*ページで、すべての設定を入力します。VLAN が使用されている場合は、正しい VLAN ID を必ず指定してください。続行するには、[次へ] をクリックします。
+
image:vmware-vcf-asa-023.png["VLAN IDを入力してください"]

+
{nbsp}

. *完了準備完了*ページで変更を確認し、*完了*をクリックして新しい分散ポート グループを作成します。
. このプロセスを繰り返して、使用されている 2 番目の NVMe/TCP ネットワークの分散ポート グループを作成し、正しい *VLAN ID* を入力したことを確認します。
. 両方のポート グループが作成されたら、最初のポート グループに移動し、[設定の編集...] アクションを選択します。
+
image:vmware-vcf-asa-077.png["DPG - 設定の編集"]

+
{nbsp}

. *分散ポート グループ - 設定の編集* ページで、左側のメニューの *チーミングとフェイルオーバー* に移動し、 *uplink2* をクリックして *未使用のアップリンク* まで下に移動します。
+
image:vmware-vcf-asa-078.png["アップリンク2を未使用に移動する"]

. 2 番目の NVMe/TCP ポート グループに対してこの手順を繰り返します。今回は、*uplink1* を *Unused uplinks* まで下に移動します。
+
image:vmware-vcf-asa-079.png["アップリンク1を未使用に移動する"]





== ステップ2: 各ESXiホストにVMkernelアダプタを作成する

ワークロード ドメイン内の各 ESXi ホストに VMkernel アダプタを作成します。

.手順
. vSphere クライアントから、ワークロード ドメイン インベントリ内の ESXi ホストの 1 つに移動します。  *構成*タブから*VMkernelアダプタ*を選択し、*ネットワークの追加...*をクリックして開始します。
+
image:vmware-vcf-asa-030.png["ネットワーク追加ウィザードを開始する"]

+
{nbsp}

. *接続タイプの選択* ウィンドウで、*VMkernel ネットワーク アダプタ* を選択し、*次へ* をクリックして続行します。
+
image:vmware-vcf-asa-008.png["VMkernelネットワークアダプタを選択"]

+
{nbsp}

. *ターゲット デバイスの選択* ページで、以前に作成した iSCSI の分散ポート グループの 1 つを選択します。
+
image:vmware-vcf-asa-095.png["ターゲットポートグループを選択"]

+
{nbsp}

. *ポート プロパティ* ページで、*NVMe/TCP* のボックスをクリックし、*次へ* をクリックして続行します。
+
image:vmware-vcf-asa-096.png["VMkernelポートのプロパティ"]

+
{nbsp}

. *IPv4 設定* ページで、*IP アドレス* と *サブネット マスク* を入力し、新しいゲートウェイ IP アドレスを指定します (必要な場合のみ)。続行するには、[次へ] をクリックします。
+
image:vmware-vcf-asa-097.png["VMkernel IPv4設定"]

+
{nbsp}

. *完了準備完了*ページで選択内容を確認し、*完了*をクリックして VMkernel アダプタを作成します。
+
image:vmware-vcf-asa-098.png["VMkernelの選択を確認する"]

+
{nbsp}

. このプロセスを繰り返して、2 番目の iSCSI ネットワーク用の VMkernel アダプタを作成します。




== ステップ3: NVMe/TCPアダプターを追加する

ワークロード ドメイン クラスタ内の各 ESXi ホストには、ストレージ トラフィック専用の確立された NVMe/TCP ネットワークごとに NVMe/TCP ソフトウェア アダプタがインストールされている必要があります。

NVMe/TCP アダプターをインストールし、NVMe コントローラーを検出するには、次の手順を実行します。

. vSphere クライアントで、ワークロード ドメイン クラスタ内の ESXi ホストの 1 つに移動します。  *構成*タブから、メニューの*ストレージ アダプタ*をクリックします。
. *ソフトウェア アダプターの追加* ドロップダウン メニューから、*NVMe over TCP アダプターの追加* を選択します。
+
image:vmware-vcf-asa-099.png["NVMe/TCPアダプタを追加する"]

+
{nbsp}

. *ソフトウェア NVMe over TCP アダプターの追加* ウィンドウで、*物理ネットワーク アダプター* ドロップダウン メニューにアクセスし、NVMe アダプターを有効にする正しい物理ネットワーク アダプターを選択します。
+
image:vmware-vcf-asa-100.png["物理アダプタを選択"]

+
{nbsp}

. NVMe/TCP トラフィックに割り当てられた 2 番目のネットワークに対してこのプロセスを繰り返し、正しい物理アダプターを割り当てます。
. 新しくインストールされた NVMe/TCP アダプターの 1 つを選択します。  *コントローラー*タブで、*コントローラーの追加*を選択します。
+
image:vmware-vcf-asa-101.png["コントローラーを追加"]

+
{nbsp}

. *コントローラーの追加* ウィンドウで、*自動* タブを選択し、次の手順を実行します。
+
.. この NVMe/TCP アダプタに割り当てられた物理アダプタと同じネットワーク上の SVM 論理インターフェイスの 1 つに IP アドレスを入力します。
.. *コントローラーの検出*ボタンをクリックします。
.. 検出されたコントローラのリストから、この NVMe/TCP アダプタと一致するネットワーク アドレスを持つ 2 つのコントローラのチェックボックスをクリックします。


. 選択したコントローラーを追加するには、[*OK*] をクリックします。
+
image:vmware-vcf-asa-102.png["コントローラーの検出と追加"]

+
{nbsp}

. 数秒後、NVMe 名前空間が [デバイス] タブに表示されます。
+
image:vmware-vcf-asa-103.png["デバイスの下にリストされているNVMe名前空間"]

+
{nbsp}

. この手順を繰り返して、NVMe/TCP トラフィック用に確立された 2 番目のネットワークの NVMe/TCP アダプターを作成します。




== 次の手順

ネットワークを設定したら、link:vmw-vcf-viwld-supp-nvme-storage.html["NVMe vVolsのストレージを構成する"] 。
